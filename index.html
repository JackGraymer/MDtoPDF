<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Markdown Editor with PDF Export</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Marked.js for markdown parsing -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- highlight.js for syntax highlighting -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <!-- GitHub Markdown CSS -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-light.min.css"
  />

  <!-- CodeMirror 5 -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/markdown/markdown.min.js"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css"
  />

  <!-- html2pdf.js for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden; /* Prevent window/page scroll */
      font-family: sans-serif;
      background: #121212;
      color: white;
      display: flex;
      flex-direction: column;
      height: 100vh; /* Full viewport height */
    }

    header {
      flex: 0 0 48px; /* Fixed height */
      background-color: #24292e;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 1rem;
      color: white;
      font-size: 1.1rem;
    }

    header .title {
  font-weight: bold;
  display: flex;
  align-items: center; 
  gap: 8px; 
}


    .buttons {
      display: flex;
      gap: 0.5rem;
    }

    header button {
      border: none;
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      border-radius: 6px;
      cursor: pointer;
      color: white;
    }

    .download-md {
      background-color: #2ea44f;
    }

    .download-md:hover {
      background-color: #279846;
    }

    .download-pdf {
      background-color: #f66a0a;
    }

    .download-pdf:hover {
      background-color: #e05500;
    }

    .main {
      flex: 1 1 auto; /* Fill remaining height */
      display: flex;
      height: calc(100vh - 48px - 32px); /* Full height minus header and footer */
    }

    #editor,
    #preview {
      width: 50%;
      height: 100%;
      overflow: auto; /* Scroll independently */
      box-sizing: border-box;
    }

    #editor {
      background: #1e1e1e;
      border-right: 1px solid #444;
    }

    .CodeMirror {
      height: 100%;
      font-size: 16px;
    }

    #preview {
      background: #fafafa;
      color: #000;
      padding: 1rem;
      overflow-y: auto;
    }

    .markdown-body {
      padding: 1rem;
    }

    pre code {
      font-size: 14px;
      border-radius: 4px;
      padding: 0.5rem;
      display: block;
      overflow-x: auto;
      background: #f6f8fa;
      color: #000;
    }

    footer {
      height: 32px;
      background-color: #24292e;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 0.9rem;
      gap: 0.5rem;
    }

    footer a {
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    footer a:hover {
      text-decoration: underline;
    }

    footer svg {
      width: 20px;
      height: 20px;
      fill: white;
    }

    @media print {
      html,
      body {
        height: auto !important;
        overflow: visible !important;
      }

      body {
        background: white !important;
        color: black !important;
        margin: 0;
        padding: 0;
      }

      .main {
        height: auto !important;
        overflow: visible !important;
        display: block !important;
      }

      header,
      #editor {
        display: none !important;
      }

      #preview {
        width: 100% !important;
        height: auto !important;
        max-height: none !important;
        overflow: visible !important;
        background: white !important;
        color: black !important;
        padding: 2rem !important;
        box-shadow: none !important;
      }

      /* Allow page breaks inside these blocks */
      pre,
      blockquote,
      table,
      ul,
      ol,
      div,
      p {
        page-break-inside: avoid;
        break-inside: avoid;
      }

      /* Ensure code blocks wrap nicely */
      pre {
        white-space: pre-wrap !important;
        word-wrap: break-word !important;
      }

      /* Remove any max heights or fixed heights on code blocks */
      pre code {
        background: #f6f8fa !important;
        color: #000 !important;
        white-space: pre-wrap !important;
        word-wrap: break-word !important;
      }
    }
  </style>
</head>
<body>
  <header>
  <div class="title">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
      <polyline points="14 2 14 8 20 8"></polyline>
      <line x1="16" y1="13" x2="8" y2="13"></line>
      <line x1="16" y1="17" x2="8" y2="17"></line>
    </svg>
    Markdown Editor
  </div>
  <div class="buttons">
    <button class="download-md" onclick="downloadMarkdown()">Download .md</button>
    <button class="download-pdf" onclick="downloadPDF()">Download PDF</button>
  </div>
</header>

  <div class="main">
    <div id="editor"></div>
    <div id="preview" class="markdown-body"></div>
  </div>

  <footer>
    <a href="https://github.com/JackGraymer" target="_blank" rel="noopener noreferrer" aria-label="JackGraymer's GitHub">
      <svg
        role="img"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.387.6.112.82-.262.82-.582 0-.287-.012-1.244-.018-2.447-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.73.083-.73 1.204.085 1.837 1.238 1.837 1.238 1.07 1.833 2.807 1.304 3.492.997.108-.776.418-1.305.76-1.605-2.665-.304-5.467-1.334-5.467-5.931 0-1.31.47-2.38 1.236-3.22-.124-.303-.536-1.527.117-3.176 0 0 1.008-.323 3.3 1.23a11.496 11.496 0 013.003-.404c1.02.005 2.05.138 3.003.404 2.29-1.553 3.297-1.23 3.297-1.23.654 1.65.243 2.873.12 3.176.77.84 1.236 1.91 1.236 3.22 0 4.61-2.807 5.624-5.48 5.921.43.37.823 1.102.823 2.222 0 1.606-.015 2.898-.015 3.293 0 .322.216.697.825.58C20.565 21.796 24 17.3 24 12c0-6.63-5.37-12-12-12z"
        />
      </svg>
        GitHub   
    </a>
  </footer>

  <script>
    // Configure marked to use highlight.js
    marked.setOptions({
      highlight: function (code, lang) {
        return hljs.highlightAuto(code, [lang]).value;
      },
    });

    const initialMarkdown = `# Heading Level 1

## Heading Level 2

### Heading Level 3

#### Heading Level 4

##### Heading Level 5

###### Heading Level 6

---

## Emphasis

**Bold text**  
*Italic text*  
***Bold and italic***  
~~Strikethrough~~

---

## Blockquote

> This is a blockquote.  
> It can span multiple lines.

---

## Lists

### Unordered List

- Item 1
- Item 2
  - Subitem A
  - Subitem B
- Item 3

### Ordered List

1. First item
2. Second item
   1. Nested item 1
   2. Nested item 2
3. Third item

---

## Code

### Inline code

Here is some \`inline code\`.

### Code block

\`\`\`javascript
// Sample JavaScript code
function greet(name) {
  console.log(\`Hello, \${name}!\`);
}
greet("world");
\`\`\`

---

## Table

| Name       | Age | Occupation     |
|------------|-----|----------------|
| Alice      | 25  | Developer      |
| Bob        | 30  | Designer       |
| Charlie    | 28  | Product Owner  |

---

## Links

[Emperor Penguin](https://en.wikipedia.org/wiki/Emperor_penguin)

---

## Images

![Emperor Penguin](https://upload.wikimedia.org/wikipedia/commons/a/a3/Aptenodytes_forsteri_-Snow_Hill_Island%2C_Antarctica_-adults_and_juvenile-8.jpg)

---

## Horizontal Rule

---

## Task List

- [x] Write Markdown
- [x] Preview it
- [ ] Export to PDF
- [ ] Profit

---

## HTML Inside Markdown

<p style="color:gray;">You can also write raw HTML if needed.</p>
`;

    const editor = CodeMirror(document.getElementById("editor"), {
      value: initialMarkdown,
      mode: "markdown",
      theme: "material-darker",
      lineNumbers: true,
      lineWrapping: true,
    });

    const preview = document.getElementById("preview");

    function updatePreview() {
      const rawMarkdown = editor.getValue();
      preview.innerHTML = marked.parse(rawMarkdown);
      document.querySelectorAll("pre code").forEach((block) => {
        hljs.highlightElement(block);
      });
    }

    editor.on("change", updatePreview);
    updatePreview(); // Initial

    function downloadMarkdown() {
      const text = editor.getValue();
      const blob = new Blob([text], { type: "text/markdown" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = "markdown.md";
      link.click();
      URL.revokeObjectURL(url);
    }

    function downloadPDF() {
      window.print();
    }
  </script>
</body>
</html>
